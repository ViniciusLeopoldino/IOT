# Mottu Vision â€“ Sistema de IdentificaÃ§Ã£o Visual de Motocicletas

![Python](https://img.shields.io/badge/Python-3.9%2B-blue.svg)
![Framework](https://img.shields.io/badge/Framework-Flask-green.svg)
![Computer Vision](https://img.shields.io/badge/Vision-OpenCV%20%7C%20YOLOv8-orange.svg)

O **Mottu Vision** Ã© um protÃ³tipo funcional que utiliza VisÃ£o Computacional para automatizar a identificaÃ§Ã£o e o registro de motocicletas em pÃ¡tios de armazenamento. O sistema detecta motocicletas em um feed de vÃ­deo ou imagem, localiza e decodifica um QR Code associado a ela e persiste os dados em um sistema de backend.

---

## ðŸŽ¯ Problema de NegÃ³cio

A gestÃ£o manual de frotas de motocicletas em grandes pÃ¡tios Ã© um processo lento, caro e sujeito a erros humanos. A necessidade de digitar informaÃ§Ãµes como placa, chassi e contrato para cada veÃ­culo consome tempo produtivo e pode levar a registros inconsistentes, dificultando a localizaÃ§Ã£o e o gerenciamento logÃ­stico dos ativos da empresa Mottu.

## ðŸ’¡ SoluÃ§Ã£o Proposta

Implementamos uma soluÃ§Ã£o de VisÃ£o Computacional que automatiza o processo de "check-in" das motocicletas. Utilizando o modelo de detecÃ§Ã£o de objetos **YOLOv8**, o sistema identifica motos em tempo real. Em seguida, dentro da Ã¡rea da moto detectada, um leitor de QR Code (`pyzbar`) extrai os dados contidos em uma etiqueta, que sÃ£o enviados via requisiÃ§Ã£o HTTP para um backend que armazena as informaÃ§Ãµes de forma persistente.

---

## ðŸ› ï¸ Arquitetura do Sistema

O projeto Ã© dividido em dois componentes principais que se comunicam via API REST:

1.  **Frontend (VisÃ£o Computacional - `mottu_vision_*.py`)**
    * ResponsÃ¡vel por capturar e processar as imagens (de cÃ¢mera, vÃ­deo ou arquivo).
    * Utiliza o modelo **YOLOv8** para detectar a classe "motorcycle".
    * Para cada moto detectada, delimita uma RegiÃ£o de Interesse (ROI).
    * Usa a biblioteca **pyzbar** para escanear a ROI em busca de QR Codes.
    * Ao encontrar e decodificar um QR Code contendo um JSON vÃ¡lido, utiliza a biblioteca **requests** para enviar os dados para o backend.
    * Fornece feedback visual em tempo real, desenhando caixas de detecÃ§Ã£o e status na imagem.

2.  **Backend (API de Armazenamento - `backend.py`)**
    * ConstruÃ­do com **Flask**, um microframework Python.
    * ExpÃµe um Ãºnico endpoint: `/armazenar_moto` (aceita requisiÃ§Ãµes `POST`).
    * Recebe os dados da moto em formato JSON.
    * Adiciona um `timestamp` ao registro.
    * Salva (persiste) os dados de forma estruturada em um arquivo **`log_motos.csv`**, funcionando como um banco de dados simplificado.
    * Retorna uma resposta de sucesso (`HTTP 200`) ou erro para o frontend.

### Fluxo de Dados
```
1. Imagem de entrada --> [mottu_vision_image.py]
                               |
2. Deteccao de Moto (YOLOv8) --> ROI
                               |
3. Leitura de QR Code (pyzbar) --> JSON com dados da moto
                               |
4. HTTP POST Request ----------> [backend.py @ /armazenar_moto]
                                                    |
5. Processamento (Flask) ---------------------------> Persistencia em log_motos.csv
                                                    |
6. HTTP 200 OK Response <------ [backend.py]
       |
7. Exibicao de "SUCESSO" na imagem <-- [mottu_vision_image.py]
```

---

## ðŸš€ Tecnologias Utilizadas

* **Linguagem:** Python 3
* **VisÃ£o Computacional:**
    * `ultralytics`: Para o modelo de detecÃ§Ã£o de objetos YOLOv8.
    * `opencv-python`: Para manipulaÃ§Ã£o de imagem e vÃ­deo.
    * `pyzbar`: Para decodificaÃ§Ã£o de cÃ³digos de barra e QR Codes.
    * `numpy`: Para operaÃ§Ãµes numÃ©ricas e manipulaÃ§Ã£o de arrays.
* **Backend:**
    * `Flask`: Para a criaÃ§Ã£o da API REST.
* **ComunicaÃ§Ã£o:**
    * `requests`: Para realizar chamadas HTTP do frontend para o backend.

---

## ðŸ“‚ Estrutura de Arquivos

```
.
â”œâ”€â”€ backend.py                # Servidor Flask que armazena os dados
â”œâ”€â”€ mottu_vision.py           # Script principal para detecÃ§Ã£o via WEBCAM
â”œâ”€â”€ mottu_vision_image.py     # Script modificado para detecÃ§Ã£o em IMAGEM ESTÃTICA
â”œâ”€â”€ requirements.txt          # Lista de dependÃªncias do projeto
â”œâ”€â”€ log_motos.csv             # Arquivo de log onde os dados sÃ£o salvos 
â”œâ”€â”€ imgs/
â”‚   â””â”€â”€ moto_com_qr.jpg       # Imagem de exemplo para teste
â”œâ”€â”€ resultados/
â”‚   â””â”€â”€ resultado_detecao.jpg # Imagem de saÃ­da com as detecÃ§Ãµes
â””â”€â”€ README.md                 # Este arquivo
```

---

## â–¶ï¸ Como Executar o Projeto

Siga os passos abaixo para configurar e rodar o ambiente localmente.

### 1. PrÃ©-requisitos
* Python 3.8 ou superior
* `pip` (gerenciador de pacotes do Python)

### 2. Clonar o RepositÃ³rio
```bash
git clone [https://github.com/SEU_USUARIO/SEU_REPOSITORIO.git](https://github.com/SEU_USUARIO/SEU_REPOSITORIO.git)
cd SEU_REPOSITORIO
```

### 3. Instalar as DependÃªncias
Ã‰ altamente recomendÃ¡vel criar um ambiente virtual.

```bash
# Criar ambiente virtual
python -m venv venv

# Ativar o ambiente virtual
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# Instalar as bibliotecas necessÃ¡rias
pip install -r requirements.txt
```

### 4. Executar o Backend
O backend precisa estar rodando para receber e salvar os dados.

```bash
python backend.py
```
O terminal deve indicar que o servidor estÃ¡ rodando em `http://127.0.0.1:5000`.

### 5. Executar o Frontend (VisÃ£o Computacional)

Abra **um novo terminal**, ative o ambiente virtual novamente e escolha uma das opÃ§Ãµes abaixo:

**OpÃ§Ã£o A: Testar com uma Imagem EstÃ¡tica (Recomendado)**
Certifique-se de ter a imagem `imgs/moto_com_qr.jpg` configurada.

```bash
python mottu_vision_image.py
```
Uma janela aparecerÃ¡ com o resultado da detecÃ§Ã£o.

**OpÃ§Ã£o B: Testar com a Webcam**
```bash
python mottu_vision.py
```
Aponte sua webcam para um QR Code para iniciar a detecÃ§Ã£o.

### 6. Como Gerar um QR Code para Teste
Use um gerador de QR Code online (como o [QR Code Generator](https://www.qr-code-generator.com/)) e insira um texto no formato JSON como o exemplo abaixo:

```json
{
  "placa": "MTO2W23",
  "chassi": "9C2KC1670GR500001",
  "modelo": "Honda Pop 110i",
  "km": "5300",
  "contrato": "987654321",
  "ocorrencia": "Arranhao no tanque"
}
```

---

## ðŸŽ¥ VÃ­deo de DemonstraÃ§Ã£o

Assista ao protÃ³tipo no YouTube:  https://www.youtube.com/watch?v=ZxqEnVOUHW

---

## ðŸ‘¨â€ðŸ’» Integrantes

* **RM:** 557047 **Nome:** Vinicius Leopoldino de Oliveira
* **RM:** 556834 **Nome:** Pablo Lopes Doria de Andrade
* **Curso:** AnÃ¡lise e Desenvolvimento de Sistemas - FIAP
* **MatÃ©ria:** Disruptive Architectures: IoT, IOB & Generative IA
